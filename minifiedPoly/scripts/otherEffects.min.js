function generateCubicPoly(a,e,r){var o=.5;for(e&&(o=e),r||(verticesHashTable=[]),generateHashSpace(),updateHashSpace(0,0,!0),updateHashSpace(cWidth,0,!0),updateHashSpace(0,cHeight,!0),updateHashSpace(cWidth,cHeight,!0),i=0;i<cWidth/a;i++)updateHashSpace(i*a,cHeight,!0),updateHashSpace(i*a,0,!0);for(i=0;i<cHeight/a;i++)updateHashSpace(cWidth,i*a,!0),updateHashSpace(0,i*a,!0);flowing=!1,!0===flowerEffect&&(flower_step=0,flowering=!0),image(img1,0,0,cWidth,cHeight),loadPixels(),splitSquare(a),scanSquareLR(a,1e8),image(img1,0,0,cWidth,cHeight),loadPixels(),scanSquareUD(a,1e8),generateRandomSquares(a,o),flowing=!0,triangulize(),finishedColoring=!1,image(img1,0,0,cWidth,cHeight),loadPixels(),tColors=[],sTime=millis(),css_buttons.displayPoints(!1),displayPoints=!1,recordVertices()}function splitSquare(a){colorOfSquares=[],image(img1,0,0,cWidth,cHeight),loadPixels();var e=cHeight/a,i=cWidth/a;for(ik=0;ik<e;ik++)for(jk=0;jk<i;jk++){var r=averageColorSquare(jk*a,ik*a,a,a,1);r.push(jk*a,ik*a),colorOfSquares.push(r)}}function averageColorSquare(a,e,r,o,n){a+o>cWidth&&(o=cWidth-a),e+r>cHeight&&(r=cHeight-e);var t=0,s=0,c=0,u=0;for(i=0;i<r;i+=n)for(j=0;j<o;j+=n){var d=fget(a+j,e+i);t+=d[0],s+=d[1],c+=d[2],u+=1}return[t/u,s/u,c/u]}function scanSquareLR(a,e,i){var r=800;for(i&&(r=i),k=0;k<colorOfSquares.length-1;k++){var o=colorOfSquares[k],n=colorOfSquares[k+1],t=o[0]-n[0],s=o[1]-n[1],c=o[2]-n[2];if(t*t+s*s+c*c>e||t*t>r||s*s>r||c*c>r)if(1==flowing){var u=round(random(-10,10)),d=round(random(-10,10));inCanvas(o[3]+u+a,o[4]+d)&&updateHashSpace(o[3]+u+a/2,o[4]+d,!0)}else inCanvas(o[3]+a/2,o[4])&&updateHashSpace(o[3]+a/2,o[4],!0)}}function scanSquareUD(a,e,i){var r=800;for(i&&(r=i),k=0;k<colorOfSquares.length-ceil(cWidth/a);k++){var o=colorOfSquares[k],n=colorOfSquares[k+ceil(cWidth/a)],t=o[0]-n[0],s=o[1]-n[1],c=o[2]-n[2];if(t*t+s*s+c*c>e||t*t>r||s*s>r||c*c>r)if(1==flowing){var u=round(random(-10,10)),d=round(random(-10,10));inCanvas(o[3]+u,o[4]+d+a/2)&&updateHashSpace(o[3]+u,o[4]+d+a/2,!0)}else inCanvas(o[3],o[4]+a/2)&&updateHashSpace(o[3],o[4]+a/2,!0)}}function generateRandomSquares(a,e){for(k=0;k<colorOfSquares.length;k++){var i=colorOfSquares[k];if(random(0,1)<=e)if(1==flowing){var r=round(random(-10,10)),o=round(random(-10,10));inCanvas(i[3]+r,i[4]+o)&&updateHashSpace(i[3]+r,i[4]+o,!0)}else inCanvas(i[3]+a/2,i[4])&&updateHashSpace(i[3]+a/2,i[4],!0)}}function autoGenPoints(a,e){pDensity=.1,e&&(pDensity=e),splitSquare(a),scanSquareLR(a,1e8),scanSquareUD(a,1e8),generateRandomSquares(a,pDensity)}