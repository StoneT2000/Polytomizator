function generateCubicPoly(e,a,r){var s=.5;for(a&&(s=a),r||(allVertices=[]),allVertices.push([0,0]),allVertices.push([cWidth,0]),allVertices.push([0,cHeight]),allVertices.push([cWidth,cHeight]),i=0;i<cWidth/e;i++)allVertices.push([i*e,cHeight]),allVertices.push([i*e,0]);for(i=0;i<cHeight/e;i++)allVertices.push([cWidth,i*e]),allVertices.push([0,i*e]);flowing=!1,image(img1,0,0,cWidth,cHeight),loadPixels(),splitSquare(e),scanSquareLR(e,1e8),image(img1,0,0,cWidth,cHeight),loadPixels(),scanSquareUD(e,1e8),generateRandomSquares(e,s),flowing=!0,generateHashSpace(),triangulize(),finishedColoring=!1,image(img1,0,0,cWidth,cHeight),loadPixels(),tColors=[],sTime=millis(),css_buttons.displayPoints(!1),displayPoints=!1,recordVertices()}function splitSquare(i){colorOfSquares=[],image(img1,0,0,cWidth,cHeight),loadPixels();var e=cHeight/i,a=cWidth/i;for(ik=0;ik<e;ik++)for(jk=0;jk<a;jk++){var r=averageColorSquare(jk*i,ik*i,i,i,1);r.push(jk*i,ik*i),colorOfSquares.push(r)}}function averageColorSquare(e,a,r,s,o){e+s>cWidth&&(s=cWidth-e),a+r>cHeight&&(r=cHeight-a);var n=0,t=0,c=0,l=0;for(i=0;i<r;i+=o)for(j=0;j<s;j+=o){var u=fget(e+j,a+i);n+=u[0],t+=u[1],c+=u[2],l+=1}return[n/l,t/l,c/l]}function scanSquareLR(i,e,a){var r=800;for(a&&(r=a),k=0;k<colorOfSquares.length-1;k++){var s=colorOfSquares[k],o=colorOfSquares[k+1],n=s[0]-o[0],t=s[1]-o[1],c=s[2]-o[2];if(n*n+t*t+c*c>e||n*n>r||t*t>r||c*c>r)if(1==flowing){var l=round(random(-10,10)),u=round(random(-10,10));inCanvas(s[3]+l+i,s[4]+u)&&allVertices.push([s[3]+l+i/2,s[4]+u])}else inCanvas(s[3]+i/2,s[4])&&allVertices.push([s[3]+i/2,s[4]])}generateHashSpace()}function scanSquareUD(i,e,a){var r=800;for(a&&(r=a),k=0;k<colorOfSquares.length-ceil(cWidth/i);k++){var s=colorOfSquares[k],o=colorOfSquares[k+ceil(cWidth/i)],n=s[0]-o[0],t=s[1]-o[1],c=s[2]-o[2];if(n*n+t*t+c*c>e||n*n>r||t*t>r||c*c>r)if(1==flowing){var l=round(random(-10,10)),u=round(random(-10,10));inCanvas(s[3]+l,s[4]+u+i/2)&&allVertices.push([s[3]+l,s[4]+u+i/2])}else inCanvas(s[3],s[4]+i/2)&&allVertices.push([s[3],s[4]+i/2])}generateHashSpace()}function generateRandomSquares(i,e){for(k=0;k<colorOfSquares.length;k++){var a=colorOfSquares[k];if(random(0,1)<=e)if(1==flowing){var r=round(random(-10,10)),s=round(random(-10,10));inCanvas(a[3]+r,a[4]+s)&&allVertices.push([a[3]+r,a[4]+s])}else inCanvas(a[3]+i/2,a[4])&&allVertices.push([a[3]+i/2,a[4]])}generateHashSpace()}function scanUD(e,a,r){for(j=0;j<cWidth-r;j+=r)for(i=0;i<cHeight-r;i+=r){var s=fget(i,j),o=fget(i,j+r/2),n=s[0]-o[0],t=s[1]-o[1],c=s[2]-o[2],l=s[3]-o[3];if((n*n+t*t+c*c+l*l>a||abs(n)>10||abs(t)>10||abs(c)>10)&&(allVertices.push([i,j]),1==flowing))for(ij=0;ij<2;ij++){var u=round(random(-10,10)),h=round(random(-10,10));i+u>cWidth-1||i+u<1||j+h>cHeight-1||j+h<1||allVertices.push([i+u,j+h])}}}function scanLR(e,a,r){for(j=0;j<cHeight-r;j+=r)for(i=0;i<cWidth-r;i+=r){var s=fget(i,j),o=fget(i+r/2,j),n=s[0]-o[0],t=s[1]-o[1],c=s[2]-o[2],l=s[3]-o[3];if((n*n+t*t+c*c+l*l>a||abs(n)>100||abs(t)>100||abs(c)>100)&&(allVertices.push([i,j]),1==flowing))for(ij=0;ij<2;ij++){var u=round(random(-10,10)),h=round(random(-10,10));i+u>cWidth-1||i+u<1||j+h>cHeight-1||j+h<1||allVertices.push([i+u,j+h])}}generateHashSpace()}function autoGenPoints(i,e){pDensity=.1,e&&(pDensity=e),splitSquare(i),scanSquareLR(i,1e8),scanSquareUD(i,1e8),generateRandomSquares(i,pDensity)}